# SmallChat with Cost TrackingüöÄ

–ü—Ä–æ—î–∫—Ç —è–≤–ª—è—î —Å–æ–±–æ—é REST API –¥–ª—è —á–∞—Ç—É –∑ –®–Ü (—á–µ—Ä–µ–∑ Groq/OpenAI), —è–∫–∏–π –≤—ñ–¥—Å—Ç–µ–∂—É—î —ñ—Å—Ç–æ—Ä—ñ—é –¥—ñ–∞–ª–æ–≥—ñ–≤ —Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ä–æ–∑—Ä–∞—Ö–æ–≤—É—î –≤–∞—Ä—Ç—ñ—Å—Ç—å –∫–æ–∂–Ω–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏—Ö —Ç–æ–∫–µ–Ω—ñ–≤.

### üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—á–Ω–∏–π —Å—Ç–µ–∫
* **Framework:** [FastAPI](https://fastapi.tiangolo.com/) (Asynchronous)
* **Database:** SQLite + [SQLAlchemy ORM](https://www.sqlalchemy.org/)
* **AI Provider:** [Groq](https://groq.com/) (OpenAI SDK Compatible)
* **Validation:** Pydantic v2
* **Frontend:** HTML5 + Tailwind CSS (Vanilla JS)
---
### ‚ú® –û—Å–Ω–æ–≤–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ
* **Session Management:** –°—Ç–≤–æ—Ä–µ–Ω–Ω—è, –≤–∏–¥–∞–ª–µ–Ω–Ω—è —Ç–∞ —Å–∫–∏–¥–∞–Ω–Ω—è —Å–µ—Å—ñ–π —á–∞—Ç—É.
* **Context Preservation:** AI "–ø–∞–º'—è—Ç–∞—î" –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤ –º–µ–∂–∞—Ö –æ–¥–Ω—ñ—î—ó —Å–µ—Å—ñ—ó.
* **Cost Calculation:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –≤–∞—Ä—Ç–æ—Å—Ç—ñ –∑–∞ —Ç–∞—Ä–∏—Ñ–∞–º–∏ *GPT-5 mini* ($0.25/$2.00 –∑–∞ 1M —Ç–æ–∫–µ–Ω—ñ–≤).
* **Minimal UI:** –Ü–Ω—Ç—É—ó—Ç–∏–≤–Ω–∏–π –≤–µ–±—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –±–µ–∑ —Å—Ç–æ—Ä–æ–Ω–Ω—ñ—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤.
* **Auto-Documentation:** –ü–æ–≤–Ω–∏–π Swagger UI –∑–∞ –∞–¥—Ä–µ—Å–æ—é `/docs`.

---
### üöÄ –®–≤–∏–¥–∫–∏–π –∑–∞–ø—É—Å–∫
1) **–ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è**
```bash
git clone <your-repository-url>
cd test_task
python -m venv venv
source venv/scripts/activate  # –î–ª—è Windows: venv\Scripts\activate
pip install -r requirements.txt
```
2) **–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞**

–°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª `.env` —É –∫–æ—Ä–µ–Ω—ñ –ø—Ä–æ—î–∫—Ç—É (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ .env.example —è–∫ –∑—Ä–∞–∑–æ–∫):
```
AI_API_KEY=your_groq_api_key
AI_MODEL_NAME=llama-3.3-70b-versatile
AI_BASE_URL=https://api.groq.com/openai/v1
DATABASE_URL=sqlite:///./chat_history.db
```
3) **–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞**

```bash
uvicorn app.main:app --reload
```
–ü—ñ—Å–ª—è –∑–∞–ø—É—Å–∫—É –ø–µ—Ä–µ–π–¥—ñ—Ç—å –∑–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º: http://127.0.0.1:8000/new_session –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–µ—Å—ñ—ó —Ç–∞ –ø–µ—Ä–µ—Ö–æ–¥—É –≤ —á–∞—Ç.

---
### üìë API Endpoints
| –ú–µ—Ç–æ–¥ | –®–ª—è—Ö | –û–ø–∏—Å |
| :--- | :--- | :--- |
| `GET` | `/new_session` | **Quick Start:** –°—Ç–≤–æ—Ä—é—î —Å–µ—Å—ñ—é —Ç–∞ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç—å –Ω–∞ UI |
| `POST` | `/sessions` | –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ—ó —Å–µ—Å—ñ—ó (–ø–æ–≤–µ—Ä—Ç–∞—î JSON) |
| `POST` | `/sessions/{uuid}/chat` | –í—ñ–¥–ø—Ä–∞–≤–∫–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Ç–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ AI |
| `GET` | `/sessions/{uuid}/history` | –û—Ç—Ä–∏–º–∞–Ω–Ω—è —ñ—Å—Ç–æ—Ä—ñ—ó —á–∞—Ç—É —Ç–∞ –∑–∞–≥–∞–ª—å–Ω–æ—ó –≤–∞—Ä—Ç–æ—Å—Ç—ñ |
| `POST` | `/sessions/{uuid}/reset` | –û—á–∏—â–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —Å–µ—Å—ñ—ó –∑—ñ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è–º UUID |
| `DELETE` | `/sessions/{uuid}` | –ü–æ–≤–Ω–µ –≤–∏–¥–∞–ª–µ–Ω–Ω—è —Å–µ—Å—ñ—ó —Ç–∞ —ñ—Å—Ç–æ—Ä—ñ—ó –∑ –ë–î |

---
### üß† –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω—ñ —Ä—ñ—à–µ–Ω–Ω—è
1) **SQLAlchemy ORM:** –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –¥–ª—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—ñ. –¶–µ –¥–æ–∑–≤–æ–ª—è—î –ª–µ–≥–∫–æ –∑–º—ñ–Ω–∏—Ç–∏ SQLite –Ω–∞ PostgreSQL –ª–∏—à–µ –∑–º—ñ–Ω–æ—é —Ä—è–¥–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è.
2) **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ—Å—Ç—å:** –£—Å—ñ –≤–∏–∫–ª–∏–∫–∏ –¥–æ AI API —Ç–∞ –¥–µ—è–∫—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó FastAPI –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ (`async/await`), —â–æ –¥–æ–∑–≤–æ–ª—è—î —Å–µ—Ä–≤–µ—Ä—É –æ–±—Ä–æ–±–ª—è—Ç–∏ –±–∞–≥–∞—Ç–æ –∑–∞–ø–∏—Ç—ñ–≤ –æ–¥–Ω–æ—á–∞—Å–Ω–æ.
3) **Pydantic Schemas:** –í—Ö—ñ–¥–Ω—ñ —Ç–∞ –≤–∏—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ —Å—É–≤–æ—Ä–æ —Ç–∏–ø—ñ–∑–æ–≤–∞–Ω—ñ, —â–æ –≤–∏–∫–ª—é—á–∞—î –ø–æ–º–∏–ª–∫–∏ —Ñ–æ—Ä–º–∞—Ç—É JSON.
4) **–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –≤–∞—Ä—Ç–æ—Å—Ç—ñ:** –ù–∞–≤—ñ—Ç—å –ø—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏—Ö –º–æ–¥–µ–ª–µ–π Groq, —É –∫–æ–¥—ñ –∑–±–µ—Ä–µ–∂–µ–Ω–∞ –ª–æ–≥—ñ–∫–∞ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –∑–∞ —Ç–∞—Ä–∏—Ñ–∞–º–∏ OpenAI.